---
title: 分布式理论
abbrlink: 6j507e71
date: 2020-9-2 23:30:44
tags: 分布式
categories: 分布式
keywords: 分布式
---
# 1.什么是I/O编程

IO在计算机中指Input/Output，也就是**输入和输出**。由于**程序**和**运行时数据**是在**内存中驻留**，由CPU这个超快的计算核心来执行，涉及到**数据交换**的地方，通常是磁盘、网络等，就需要IO接口。

比如你打开浏览器，访问新浪首页，浏览器这个程序就需要通过网络IO获取新浪的网页。浏览器首先会发送数据给新浪服务器，告诉它我想要首页的HTML，这个动作是往外发数据，叫Output，随后新浪服务器把网页发过来，这个动作是从外面接收数据，叫Input。所以，通常，程序完成IO操作会有Input和Output两个数据流。当然也有只用一个的情况，比如，从磁盘读取文件到内存，就只有Input操作，反过来，把数据写到磁盘文件里，就只是一个Output操作。

IO编程中，**Stream**（流）是一个很重要的概念，可以把流想象成一个水管，数据就是水管里的水，但是只能单向流动。Input Stream就是数据从外面（磁盘、网络）流进内存，Output Stream就是数据从内存流到外面去。对于浏览网页来说，浏览器和新浪服务器之间至少需要建立两根水管，才可以既能发数据，又能收数据。

小结一下：**程序运行是依靠cpu和内存来进行的，<u>I/O操作是相对于内存而言的</u>，从外部设备进入内存就叫Input，反之从内存输出到外部设备就叫Output。**

I/O按照设备来分的话，分为两种：

**其一是网络I/O，也就是通过网络进行数据的拉取和输出。**

**还有一种是磁盘I/O，主要是对磁盘进行读写工作。**



可以说在计算机系统中，IO流是不可缺少的元素，因为IO流是用户和电脑交互的管道、媒介，没有IO就无法交互。



# 2.阻塞、非阻塞、同步、异步分析

由于CPU和内存的速度远远高于外设的速度，所以，在IO编程中，就存在速度严重不匹配的问题。举个例子来说，比如要把100M的数据写入磁盘，CPU输出100M的数据只需要0.01秒，可是磁盘要接收这100M数据可能需要10秒，怎么办呢？

这就牵扯出来了**同步、异步、阻塞与非阻塞**这些概念。

举一个烧水的例子来具体解释这几个概念。
说到烧水，我们都是通过热水壶来烧水的。在很久之前，科技还没有这么发达的时候，如果我们要烧水，需要把水壶放到火炉上，我们通过观察水壶内的水的沸腾程度来判断水有没有烧开。

随着科技的发展，现在市面上的水壶都有了提醒功能，当我们把水壶插电之后，水壶水烧开之后会通过声音提醒我们水开了。



## 2.1 什么是同步、异步

对于烧水这件事儿来说，传统水壶的烧水就是同步的，高科技水壶的烧水就是异步的。

**同步请求**，A调用B，B的处理是同步的，在处理完之前他不会通知A，只有处理完之后才会明确的通知A。

**异步请求**，A调用B，B的处理是异步的，B在接到请求后先告诉A我已经接到请求了，然后异步去处理，处理完之后通过回调等方式再通知A。

所以说，**同步和异步最大的区别就是被调用方的执行方式和返回时机**。

同步指的是被调用方做完事情之后再返回；异步指的是被调用方先返回，然后再做事情，做完之后再想办法通知调用方。



## 2.2 什么是阻塞和非阻塞

还是那个烧水的例子，当你把水放到水壶里面，按下开关后，你可以坐在水壶前面，别的事情什么都不做，一直等着水烧好。你还可以先去客厅看电视，等着水开就好了。

对于你来说，坐在水壶前面等就是阻塞的，去客厅看电视等着水开就是非阻塞的。

**阻塞请求**，A调用B，A一直等着B的返回，别的事情什么也不干。

**非阻塞请求**，A调用B，A不用一直等着B的返回，先去忙别的事情了。

所以说，**同步和异步最大的区别就是在被调用方返回结果之前的这段时间内，调用方是否一直等待**。

**阻塞指的是调用方一直等待别的事情什么都不做。非阻塞指的是调用方先去忙别的事情**。



## 2.3 阻塞、非阻塞和同步、异步的区别

阻塞：体现在这个线程不能干别的了，只能在这里等着。
同步：是体现在消息**通知机制**上的。



同步和异步说的是消息的**通知机制**，阻塞非阻塞说的是**线程的状态** 。



同步是一直等到线程运行结束后返回；异步是发出命令后可以去做其他事情，等线程运行结束后通过回调方式通知。

> 参考
>
> https://blog.csdn.net/hufi320/article/details/104411482





有人认为阻塞和同步是一回事儿，非阻塞和异步是一回事。但是这是不对的。

首先，前面已经提到过，阻塞、非阻塞和同步、异步其实**针对的对象不一样**。**阻塞、非阻塞说的是调用者**，**同步、异步说的是被调用者**。

**针对于上文所说的烧水的案例来说，阻塞与非阻塞是形容调用者人的，而同步和异步是形容被调用者烧水这件事儿。**
同步里面可以有阻塞的情形，也可以有非阻塞的性情。异步也可以有阻塞的情形和非阻塞的情形。 



先来看同步场景中是如何包含阻塞和非阻塞情况的

> 我们是用传统的水壶烧水。在水烧开之前我们一直做在水壶前面，等着水开。这就是阻塞的。
>
> 我们是用传统的水壶烧水。在水烧开之前我们先去客厅看电视了，但是水壶不会主动通知我们，需要我们时不时的去厨房看一下水有没有烧开。这就是非阻塞的。
>



再来看异步场景中是如何包含阻塞和非阻塞情况的

> 我们是用带有提醒功能的水壶烧水。在水烧发出提醒之前我们一直做在水壶前面，等着水开。这就是阻塞的。
>
> 我们是用带有提醒功能的水壶烧水。在水烧发出提醒之前我们先去客厅看电视了，等水壶发出声音提醒我们。这就是非阻塞的。



## 2.4 编程实现（BIO\NIO\AIO）

在真实的编程环境中，阻塞、非阻塞和同步、异步之间的组合并不是都存在的。

在Java语言中，一共提供了三种IO模型，分别是**阻塞IO（BIO）、非阻塞IO（NIO）、异步IO（AIO）**。

这里面的**BIO和NIO都是同步的IO模型**，即同步阻塞IO和同步非阻塞IO，**异步IO\AIO指的是异步非阻塞IO**。

BIO （Blocking I/O）：同步阻塞I/O模式，数据的读取写入必须阻塞在一个线程内等待其完成。

NIO （New I/O）：同时支持阻塞与非阻塞模式，但主要是使用同步非阻塞IO。

AIO （Asynchronous I/O）：异步非阻塞I/O模型。



**可以拿烧水的例子来解释这三种I/O模型**

BIO （Blocking I/O）：有一排水壶在烧开水，BIO的工作模式就是，叫一个线程停留在一个水壶那，直到这个水壶烧开，才去处理下一个水壶。但是实际上线程在等待水壶烧开的时间段什么都没有做。

NIO （New I/O）：NIO的做法是叫一个线程不断的轮询每个水壶的状态，看看是否有水壶的状态发生了改变，从而进行下一步的操作。

AIO （ Asynchronous I/O）：为每个水壶上面装了一个开关，水烧开之后，水壶会自动通知我水烧开了。



————————————————
版权声明：本文为CSDN博主「海鲜粥」的原创文章，遵循CC 4.0 BY-SA版权协议，转载请附上原文出处链接及本声明。
原文链接：https://blog.csdn.net/gui951753/article/details/82345237